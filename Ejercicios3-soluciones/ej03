programa ej03
procesos
  proceso maximo(ES max:numero ; ES maxId:numero ; E id:numero ; E f:numero)
  comenzar
    si(f > max)
      max:= f
      maxId:= id
  fin
areas
  area1: AreaPC(2, 2, 10, 10)
  area2: AreaP(1, 1, 1, 1)
  area3: AreaP(2, 1, 2, 1)
  area4: AreaP(3, 1, 3, 1)
  area5: AreaP(4, 1, 4, 1)
  area6: AreaP(5, 1, 5, 1)
robots
  robot fiscalizador
  variables
    av, ca, max, maxId, id, flores:numero
  comenzar
    max:= 0
    maxId:= 0
    Random(av, 2, 10)
    Random(ca, 2, 10)
    EnviarMensaje(1, r1)
    EnviarMensaje(av, r1)
    EnviarMensaje(ca, r1)
    EnviarMensaje(2, r2)
    EnviarMensaje(av, r2)
    EnviarMensaje(ca, r2)
    EnviarMensaje(3, r3)
    EnviarMensaje(av, r3)
    EnviarMensaje(ca, r3)
    EnviarMensaje(4, r4)
    EnviarMensaje(av, r4)
    EnviarMensaje(ca, r4)
    repetir 4
      RecibirMensaje(id, *)
      RecibirMensaje(flores, *)
      maximo(max, maxId, id, flores)
    si (maxId = 1)
      Informar(1)
    sino
      si (maxId = 2)
        Informar(2)
      sino
        si (maxId = 3)
          Informar(3)
        sino
          Informar(4)
  fin
  robot florero
  variables
    avIn, caIn, av, ca, flores, id:numero
  comenzar
    avIn:= PosAv
    caIn:= PosCa
    RecibirMensaje(id, rf)
    RecibirMensaje(av, rf)
    RecibirMensaje(ca, rf)
    BloquearEsquina(av, ca)
    flores:= 0
    Pos(av, ca)
    si(HayFlorEnLaEsquina)
      tomarFlor
      flores:= flores + 1
    sino
      EnviarMensaje(id, rf)
      EnviarMensaje(flores, rf)
    Pos(avIn, caIn)
    LiberarEsquina(av, ca)
  fin
variables
  r1: florero
  r2: florero
  r3: florero
  r4: florero
  rf: fiscalizador
comenzar
  AsignarArea(r1, area1)
  AsignarArea(r1, area3)
  AsignarArea(r2, area1)
  AsignarArea(r2, area4)
  AsignarArea(r3, area1)
  AsignarArea(r3, area5)
  AsignarArea(r4, area1)
  AsignarArea(r4, area6)
  AsignarArea(rf, area2)
  Iniciar(r1, 2, 1)
  Iniciar(r2, 3, 1)
  Iniciar(r3, 4, 1)
  Iniciar(r4, 5, 1)
  Iniciar(rf, 1, 1)
fin